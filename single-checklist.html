<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<title>OpenRMF - Checklist Record</title>
		<meta name="description" content="OpenRMF Checklist">
		<meta name="author" content="Dale Bingham - https://www.cingulara.com">

		<!-- Favicon -->
		<link rel="shortcut icon" href="assets/images/favicon.ico">
		<link rel="apple-touch-icon" sizes="57x57" href="assets/favicons/apple-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="assets/favicons/apple-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="assets/favicons/apple-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="assets/favicons/apple-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="assets/favicons/apple-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="assets/favicons/apple-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="assets/favicons/apple-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="assets/favicons/apple-icon-152x152.png">
		<link rel="apple-touch-icon" sizes="180x180" href="assets/favicons/apple-icon-180x180.png">
		<link rel="icon" type="image/png" sizes="192x192"  href="assets/favicons/android-icon-192x192.png">
		<link rel="icon" type="image/png" sizes="32x32" href="assets/favicons/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="96x96" href="assets/favicons/favicon-96x96.png">
		<link rel="icon" type="image/png" sizes="16x16" href="assets/favicons/favicon-16x16.png">
		<link rel="manifest" href="assets/favicons/manifest.json">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
		<meta name="theme-color" content="#ffffff">

		<!-- Bootstrap CSS -->
		<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		
		<!-- Font Awesome CSS -->
		<link href="assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
		
		<!-- Custom CSS -->
		<link href="assets/css/style.css" rel="stylesheet" type="text/css" />
		<link href="assets/plugins/sweetalert/sweetalert.css" rel="stylesheet" type="text/css" />
		
		<!-- BEGIN CSS for this page -->
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css"/>
		<link href="assets/css/pricing-tables.css" rel="stylesheet" type="text/css" />
		<link href="assets/plugins/jstree/style.css" rel="stylesheet" type="text/css"/>
		<!-- END CSS for this page -->
</head>

<body class="adminbody">
	<script src="assets/js/keycloak.min.js"></script>
	<script src="./js/auth.js"></script>
<div id="main">

	<!-- top bar navigation -->
	<div class="headerbar">

		<!-- LOGO -->
    <div class="headerbar-left">
			<a href="index.html" class="logo"><img alt="Logo" src="assets/images/logo.png" /> <span>OpenRMF</span></a>
    </div>

    <nav class="navbar-custom">
			<ul class="list-inline float-right mb-0">
				<li class="list-inline-item dropdown notif">
					<a class="nav-link dropdown-toggle arrow-none" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
						<i class="fa fa-fw fa-question-circle"></i>
					</a>
					<div class="dropdown-menu dropdown-menu-right dropdown-arrow dropdown-arrow-success dropdown-lg">
						<!-- item-->
						<div class="dropdown-item noti-title">
							<h5><small>Help and Support</small></h5>
						</div>

						<!-- item-->
						<a target="_blank" href="https://www.github.com/cingulara/openrmf-docs/" class="dropdown-item notify-item">                                    
							<p class="notify-details ml-0">
								<b>Do you need documentation on how OpenRMF works?</b>
								<span>GitHub Readme</span>
							</p>
						</a>
					</div>
				</li>
				<li class="list-inline-item dropdown notif">
					<a class="nav-link dropdown-toggle nav-user" data-toggle="dropdown" 
						href="#" role="button" aria-haspopup="false" aria-expanded="false">
						<img src="assets/images/avatars/avatar3.png" alt="Profile image" 
						class="avatar-rounded">
					</a>
					<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
						<!-- item-->
						<div class="dropdown-item noti-title">
							<h5 class="text-overflow"><small>Hello, <span id="profileUserName"></span></small> </h5>
						</div>

						<!-- item-->
						<a id="profileAccountURL" href="" class="dropdown-item notify-item">
							<i class="fa fa-user"></i> <span>Profile</span>
						</a>

						<!-- item-->
            <a id="profileLogoutURL" 
              href="" 
							class="dropdown-item notify-item">
							<i class="fa fa-power-off"></i> <span>Logout</span>
						</a>
					</div>
				</li>
			</ul>
			<ul class="list-inline menu-left mb-0">
				<li class="float-left">
					<button class="button-menu-mobile open-left">
						<i class="fa fa-fw fa-bars"></i>
					</button>
				</li>                        
			</ul>
    </nav>
	</div>
	<!-- End Navigation -->

	<!-- Left Sidebar -->
	<div class="left main-sidebar">
		<div class="sidebar-inner leftscroll">
			<div id="sidebar-menu">
			<ul>
				<li class="submenu">
					<a href="index.html"><i class="fa fa-fw fa-dashboard"></i><span> Dashboard </span> </a>
				</li>
				<li class="submenu">
					<a class="active" href="checklists.html"><i class="fa fa-fw fa-table"></i><span> Checklists </span> </a>
				</li>
				<li class="submenu">
					<a href="compliance.html"><i class="fa fa-fw fa-check-square-o"></i><span> Compliance </span> </a>
				</li>
				<li class="submenu">
					<a href="templates.html"><i class="fa fa-fw fa-list"></i><span> Templates </span> </a>
				</li>
				<li class="submenu">
					<a href="charts.html"><i class="fa fa-fw fa-area-chart"></i><span> Reports </span> </a>
				</li>
				<li class="submenu" id="menuUpload" style="display: none;">
					<a href="upload.html"><i class="fa fa-fw fa-file-text-o"></i><span> Upload </span> </a>
				</li>
            </ul>
            <div class="clearfix"></div>
			</div>
			<div class="clearfix"></div>
		</div>
	</div>
	<!-- End Sidebar -->
    <div class="content-page">	
		<!-- Start content -->
        <div class="content">            
			<div class="container-fluid">					
				<div class="row">
					<div class="col-xl-12">
						<div class="breadcrumb-holder">
							<h1 class="main-title float-left">My Checklist</h1>
							<ol class="breadcrumb float-right">
								<li class="breadcrumb-item">Home</li>
								<li class="breadcrumb-item active">Checklist</li>
							</ol>
							<div class="clearfix"></div>
						</div>
					</div>
				</div>
				<!-- end row -->
				<div class="row">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
						<div class="card mb-3">
							<div class="card-header">
								<h3 id="checklistTitle" class="float-left"></h3>
								<a href="#custom-modal"  id="btnUpdateChecklist" style="display: none;"  class="btn btn-primary btn-sm m-r-5 m-b-10 float-right" 
									data-target="#customModal" data-toggle="modal">Update Checklist Data</a>
							</div>								
							<div class="card-body">
								<table class="table table-condensed table-hover table-bordered table-responsive-md">
								<thead>
                  <tr>
                    <th></th>
                    <th class="tabco2">Not a Finding</th>
                    <th class="tabco3">Not Applicable</th>
                    <th class="tabco4">Open</th>
                    <th class="tabco5">Not Reviewed</th>
                  </tr>
								</thead>
								<tbody>
                  <tr>
                    <td>Total</td>
                    <td class="tabco2"><i class="fa" aria-hidden="true"></i><span id="checklistNotAFindingCount"></span></td>
                    <td class="tabco3"><i class="fa" aria-hidden="true"></i><span id="checklistNotApplicableCount"></span></td>
                    <td class="tabco4"><i class="fa" aria-hidden="true"></i><span id="checklistOpenCount"></span></td>
                    <td class="tabco5"><i class="fa" aria-hidden="true"></i><span id="checklistNotReviewedCount"></span></td>
                  </tr>
                  <tr>
                    <td style="text-align: right;">CAT 1</td>
                    <td class="tabco2"><i class="fa" aria-hidden="true"></i><span id="cat1NotAFindingCount"></span></td>
                    <td class="tabco3"><i class="fa" aria-hidden="true"></i><span id="cat1NotApplicableCount"></span></td>
                    <td class="tabco4"><i class="fa" aria-hidden="true"></i><span id="cat1OpenCount"></span></td>
                    <td class="tabco5"><i class="fa" aria-hidden="true"></i><span id="cat1NotReviewedCount"></span></td>
                  </tr>
                  <tr>
                    <td style="text-align: right;">CAT 2</td>
                    <td class="tabco2"><i class="fa" aria-hidden="true"></i><span id="cat2NotAFindingCount"></span></td>
                    <td class="tabco3"><i class="fa" aria-hidden="true"></i><span id="cat2NotApplicableCount"></span></td>
                    <td class="tabco4"><i class="fa" aria-hidden="true"></i><span id="cat2OpenCount"></span></td>
                    <td class="tabco5"><i class="fa" aria-hidden="true"></i><span id="cat2NotReviewedCount"></span></td>
                  </tr>
                  <tr>
                    <td style="text-align: right;">CAT 3</td>
                    <td class="tabco2"><i class="fa" aria-hidden="true"></i><span id="cat3NotAFindingCount"></span></td>
                    <td class="tabco3"><i class="fa" aria-hidden="true"></i><span id="cat3NotApplicableCount"></span></td>
                    <td class="tabco4"><i class="fa" aria-hidden="true"></i><span id="cat3OpenCount"></span></td>
                    <td class="tabco5"><i class="fa" aria-hidden="true"></i><span id="cat3NotReviewedCount"></span></td>
                  </tr>
                </tbody>
								</table>
								<div class="small" id="checklistLastUpdated"></div><br />
								<button type="button" id="btnDownloadChecklist" style="display: none;" onclick="downloadChecklistFile(getParameterByName('id'), false);" 
									class="btn btn-info btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Download</button>
								<button type="button" id="btnExportChecklist" style="display: none;" onclick="exportChecklistXLSX(getParameterByName('id'), false);" 
									class="btn btn-success btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Export to Excel</button>
								<button type="button" id="btnDeleteChecklist" style="display: none;" onclick="deleteChecklist(getParameterByName('id'), false);" 
									class="btn btn-danger btn-sm"><span class="btn-label"><i class="fa fa-remove"></i></span> Delete Checklist</button>
							</div><!-- end card body -->															
						</div><!-- end card-->					
					</div>		
				</div><!-- end row-->
				
				<div class="row">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6">
						<div class="card mb-3">
							<div class="card-header">
								<h3 class="float-left">STIG Information</h3>
							</div>								
							<div class="card-body">
								<div id="checklistSTIGTitle"></div>
								<div id="checklistSTIGReleaseInfo"></div>
								<div id="checklistSTIGDescription"></div>
							</div><!-- end card body -->															
						</div><!-- end card-->					
					</div>	
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6">
						<div class="card mb-3">
							<div class="card-header">
								<h3 class="float-left">Asset Information</h3>
							</div>								
							<div class="card-body">
								<div id="checklistSystem"></div>
								<div id="checklistHost"></div>
								<div id="checklistFQDN"></div>
								<div id="checklistTechArea"></div>
								<div id="checklistAssetType"></div>
								<div id="checklistRole"></div>
							</div><!-- end card body -->															
						</div><!-- end card-->
					</div>
				</div><!-- end row-->
				
				<div class="row" id="rowControlInformation" style="display: none;">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
						<div class="card mb-3">
							<div class="card-header">
								<h3 class="float-left"><div id="checklistControlTitle"></div></h3>
							</div>								
							<div class="card-body">
								<div id="checklistControlGuidance"></div>
							</div><!-- end card body -->															
						</div><!-- end card-->					
					</div>	
				</div><!-- end row-->

				<div class="row">
					<div class="col-xs-12 col-sm-12 col-md-4 col-lg-2 col-xl-2">
						<div class="card mb-3">
							<div class="card-header">
								<h3><i class="fa fa-folder-open-o"></i> Vuln Ids</h3>
							</div>
							<div class="card-body">				
								<div class="row" id="divVulnFilter" style="display: none;">
									<div class="col-xl-12">
										<div>			
											<div class="row">
												<div class="col-xl-6">
													<input id="chkVulnOpen" type="checkbox" checked="true" onchange="updateVulnerabilityListingByFilter();"> <span class="vulnOpenText">Open</span><br /> 
													<input id="chkVulnNaF" type="checkbox" checked="true" onchange="updateVulnerabilityListingByFilter();"> <span class="vulnNotAFindingText">NaF</span>
												</div>
												<div class="col-xl-6">
													<input id="chkVulnNA" type="checkbox" checked="true" onchange="updateVulnerabilityListingByFilter();"> <span class="vulnNotApplicableText">N/A</span><br /> 
													<input id="chkVulnNR" type="checkbox" checked="true" onchange="updateVulnerabilityListingByFilter();"> <span class="vulnNotReviewedText">NR</span>
												</div>
											</div>
										</div>
									</div>
								</div>			
								<div class="row">
									<div class="col-xl-12">
										<div id="checklistTree" class="vulnListing scrollableDiv"></div>
									</div>			
								</div>
							</div>
						</div>
					</div><!-- end card-->
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-10 col-xl-10">
						<div class="card mb-3">
							<div class="card-header">
								<h3><i class="fa fa-folder-open-o"></i> Vulnerability Details</h3>
							</div>
							<div class="card-body">
								<div class="vulnListingDetail scrollableDiv">
									<div class="vulnSpacing" id="vulnId">Select a Vulnerability ID to view details</div>
									<div class="vulnSpacing" id="vulnStigId"></div>
									<div class="vulnSpacing" id="vulnStatus"></div>
									<div class="vulnSpacing" id="vulnSeverity"></div>
									<div class="vulnSpacing" id="vulnRuleId"></div>
									<div class="vulnSpacing" id="vulnRuleName"></div>
									<div class="vulnSpacing" id="vulnCCIId"></div>
									<div class="vulnSpacing" id="vulnRuleTitle"></div>
									<div class="vulnSpacing" id="vulnClassification"></div>
									<div class="vulnSpacing" id="vulnDiscussion"></div>
									<div class="vulnSpacing" id="vulnCheckText"></div>
									<div class="vulnSpacing" id="vulnFixText"></div>
									<div class="vulnSpacing" id="vulnFindingDetails"></div>
									<div class="vulnSpacing" id="vulnComments"></div>
									<div class="vulnSpacing" id="vulnReferences"></div>
								</div>
							</div>
						</div>
					</div><!-- end card-->
				</div>
				<div class="row">
					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">						
						<div class="card mb-3">
							<div class="card-header">
								<i class="fa fa-table"></i> Severity Breakdown
							</div>
								
							<div class="card-body">
								<canvas id="chartSeverity"></canvas>
							</div>
							<div id="chartSeverityUpdated" class="card-footer small text-muted"></div>
							<button type="button" id="btnDownloadChartSeverity" style="display: none;" onclick="downloadChart('chartSeverity');" style="width: 200px;"
								class="btn btn-info btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Save Chart</button>
						</div><!-- end card-->					
					</div>
					
					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">						
						<div class="card mb-3">
							<div class="card-header">
								<i class="fa fa-table"></i> Category Breakdown
							</div>
								
							<div class="card-body">
								<canvas id="chartCategory"></canvas>
							</div>
							<div id="chartCategoryUpdated" class="card-footer small text-muted"></div>
							<button type="button" id="btnDownloadChartCategory" style="display: none;" onclick="downloadChart('chartCategory');" style="width: 200px;"
								class="btn btn-info btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Save Chart</button>
						</div><!-- end card-->					
					</div>							
				</div>				
				<div class="row">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">						
						<div class="card mb-3">
							<div class="card-header">
								<i class="fa fa-table"></i> Checklist Score Breakdown
							</div>
								
							<div class="card-body">
								<canvas id="barChart"></canvas>
							</div>							
							<div id="barChartUpdated" class="card-footer small text-muted"></div>
							<button type="button" id="btnDownloadBarChart" style="display: none;"  onclick="downloadChart('barChart');" style="width: 200px;"
								class="btn btn-info btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Save Chart</button>
						</div><!-- end card-->					
					</div>
				</div>

            </div>
			<!-- END container-fluid -->
		</div>
		<!-- END content -->
    </div>
	<!-- END content-page -->
    
	<footer class="footer">
		<span class="text-right">
		&copy; <a target="_blank" href="#">Cingulara 2019</a>
		</span>
		<span class="float-right">
		Powered by <a target="_blank" href="https://www.pikeadmin.com"><b>Pike Admin</b></a>
		</span>
	</footer>

</div>
<!-- END main -->

<script src="assets/js/modernizr.min.js"></script>
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/moment.min.js"></script>

<script src="assets/js/popper.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>

<script src="assets/js/detect.js"></script>
<script src="assets/js/fastclick.js"></script>
<script src="assets/js/jquery.blockUI.js"></script>
<script src="assets/js/jquery.nicescroll.js"></script>
<script src="assets/js/jquery.scrollTo.min.js"></script>
<script src="assets/plugins/switchery/switchery.min.js"></script>
<script src="assets/plugins/sweetalert/sweetalert.js"></script>

<!-- App js -->
<script src="assets/js/pikeadmin.js"></script>

<!-- BEGIN Java Script for this page -->
<script src="js/moment.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="./js/openrmf.js"></script>
<script src="./js/apis.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<script>
	$(document).ready(function() {
		// authentication first
		keycloak.init({onLoad: 'login-required' }).success(function(authenticated) {
			if (authenticated) {
				// setup the profile account and logout menu
				setupProfileMenu();
				// see if the upload menu should show
				verifyUploadMenu();
				// check if they can download
				verifyDownloadSingleChecklist();
				// check if they can delete a checklist
				verifyDeleteChecklist();
				// check if they can update the checklist
				verifyUpdateChecklist();
				// calls to get the checklist data from the API
				getChecklistData(getParameterByName('id'), false);
				getChecklistScore(getParameterByName('id'));
			}
			else {
				swal("Invalid Login", "You are not logged in. Please check your setup with Keycloak.", "error");
			}
		}).error(function() {
			swal("Invalid Login", "Keycloak did not respond correctly. Please verify your Keycloak realm as well as Redirect URI and Web Origins information. (i.e. are you missing an '*' somewhere?", "error");
		});
	}); // document ready
</script>
<!-- END Java Script for this page -->

<!-- Update Modal -->
<div class="modal fade customModal" id="customModal" tabindex="-1" role="dialog" aria-labelledby="customModal" aria-hidden="true">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel2">Update Your Checklist</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<div class="form-group" id="divfrmChecklistSystem">
					<label for="frmChecklistSystem">System Name (required)</label>
					<select class="form-control select2" id="frmChecklistSystem">
							<option value="">Choose one...</option>
							<option value="None">None</option>
					</select>
					<small id="titleHelp" class="form-text text-muted">Select the system this belongs to, or 'None'</small>
				</div>
				<div class="form-group" id="divfrmChecklistSystemText">
					<label for="frmChecklistSystemText">New System Name</label>
					<input type="text" class="form-control" id="frmChecklistSystemText" 
					aria-describedby="titleHelp" placeholder="Enter a new System Name (if any)" required>
					<small id="titleHelp" class="form-text text-muted">Enter a new system if not in the list above</small>
				</div>
				<div class="form-group">
					<label for="frmChecklistFile">Checklist File (required)</label><br />
					<input type="file" id="checklistFile" /> 
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" onclick="updateSingleChecklist(getParameterByName('id'));">Save changes</button>
			</div>
			</div>
		</div>
	</div>
</body>
</html>